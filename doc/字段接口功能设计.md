下面是一个多人共享的书签系统的详细设计，包括用户、书签、分类和标签等模块的字段、功能和 API 设计。

### 1. 用户模块 （管理员、普通用户、匿名用户(未登录) 通过浏览器指纹登录）
#### 字段
- `user_id`：唯一标识符 uuid
- `username`：用户名
- `email`：邮箱
- `avatar`: 头像
- `introduction`：简介
- `website_url`：个人网站(可选)
- `github_url`：GitHub 地址(可选)
- `twitter_url`：Twitter 地址(可选)
- `facebook_url`：Facebook 地址(可选)
- `linkedin_url`：LinkedIn 地址(可选)
- `instagram_url`：Instagram 地址(可选)
- `youtube_url`：YouTube 地址(可选)
- `kaggle_url`：Kaggle 地址(可选)
- `twitch_url`：Twitch 地址(可选)
- `telegram_url`：Telegram 地址(可选)
- `discord_url`：Discord 地址(可选)
- `weibo_url`：微博地址(可选)
- `password_hash`：密码哈希
- `password_salt`：密码盐(用于密码加盐)(用户注册自动生成, 用于生成`password_hash` 以及分享链接)
- `created_at`：创建时间(用户注册自动生成)
- `updated_at`：更新时间
- `last_login_at`：最后登录时间
- `last_login_ip`：最后登录IP
- `is_deleted`：是否删除
- `deleted_at`：删除时间

#### 功能
- 注册用户(必须通过分享链接才能注册，自动生成密码盐和密码哈希)
- 用户登录/登出
- 更新用户信息
- 删除用户账户

#### API 设计
- `POST /api/users/verify-invitation-link`：验证邀请链接
- `POST /api/users/register`：注册新用户
- `POST /api/users/login`：用户登录
- `GET /api/users/:user_id`：获取用户信息
- `PUT /api/users/:user_id`：更新用户信息
- `DELETE /api/users/:user_id`：删除用户账户
- `POST /api/users/logout`：用户登出
---

### 2. 书签模块 (书签扩展至 文章、笔记等) 字段基本相同
#### 字段
- `bookmark_id`：唯一标识符 uuid
- `user_id`：创建者ID
- `title`：书签标题
- `content`：书签内容
- `md_content`：markdown 内容
- `url`：书签链接
- `icon`：书签图标
- `category_id`：分类ID
- `tag_ids`：标签ID(多选)
- `description`：书签描述
- `created_at`：创建时间
- `updated_at`：更新时间
- `visibility`：可见性（公开、私有）私有则不会在主站显示
- `is_published`：是否发布
- `is_encrypted`: 是否加密 (加密后的不能被检索到， 只能登录用户自己访问或通过分享、共享链接访问)
- `password_hash`：密码哈希 (加密后，需要密码才能访问具体内容)
- `is_reprint`: 是否转载
- `reprint_url`: 转载链接
- `reprint_author`: 转载作者
- `reprint_title`: 转载标题
- `reprint_description`: 转载描述
- `reprint_icon`: 转载图标
- `reprint_copyright`: 转载版权

#### 功能
- 添加书签
- 编辑书签
- 删除书签
- 查看书签详情
- 获取书签列表

#### API 设计
- `POST /api/bookmarks`：添加新书签
- `GET /api/bookmarks`：获取当前用户的书签列表
- `GET /api/bookmarks/:bookmark_id`：获取书签详情
- `PUT /api/bookmarks/:bookmark_id`：更新书签信息
- `DELETE /api/bookmarks/:bookmark_id`：删除书签
- `GET /api/bookmarks/?bookmark_id=:bookmark_id&bookmark_title=:bookmark_title&bookmark_url=:bookmark_url&bookmark_category_id=:bookmark_category_id&bookmark_tag_ids=:bookmark_tag_ids`：搜索书签
- `GET /api/bookmarks/:bookmark_id/share`：获取书签分享链接

---

### 3. 分类模块
#### 字段
- `category_id`：唯一标识符 uuid
- `user_id`：用户ID
- `title`：分类名称
- `icon`：分类图标
- `description`：分类描述
- `color`：分类颜色
- `order`：排序
- `visibility`：可见性（公开、私有） 私有则整个分类都不会在主站显示
- `created_at`：创建时间
- `updated_at`：更新时间

#### 功能
- 创建分类
- 编辑分类
- 删除分类
- 获取用户的分类列表

#### API 设计
- `POST /api/categories`：创建新分类
- `GET /api/categories`：获取用户的分类列表
- `PUT /api/categories/:category_id`：更新分类信息
- `DELETE /api/categories/:category_id`：删除分类

---

### 4. 标签模块
#### 字段
- `tag_id`：唯一标识符 uuid
- `title`：标签名称
- `icon`：标签图标
- `description`：标签描述
- `created_at`：创建时间
- `updated_at`：更新时间

#### 功能
- 创建标签
- 删除标签
- 获取所有标签

#### API 设计
- `POST /api/tags`：创建新标签
- `GET /api/tags`：获取所有标签
- `DELETE /api/tags/:tag_id`：删除标签

---

### 5. 共享功能
#### 字段
- `collaborate_id`：唯一标识符 uuid
- `bookmark_id`：书签ID
- `collaborated_with_user_id`：共享给的用户ID
- `permission`：权限（只读、可编辑）
- `created_at`：创建时间
- `updated_at`：更新时间

#### 功能
- 共享书签
- 查看共享书签
- 接受/拒绝共享请求

#### API 设计
- `POST /api/shares`：共享书签
- `GET /api/shares/:user_id`：获取用户共享的书签
- `PUT /api/shares/:share_id`：更新共享权限
- `DELETE /api/shares/:share_id`：取消共享

---

### 6. 搜索功能
#### 功能
- 允许用户根据书签的标题、URL、描述或标签进行关键词搜索。

#### API 设计
- `GET /api/bookmarks/search?query={keyword}`：根据关键词搜索书签。
    - **参数**：
        - `query`: 用户输入的搜索关键词。

### 过滤功能
#### 功能
- 允许用户根据不同的标准（如分类、标签、可见性等）过滤书签。

#### API 设计
- `GET /api/bookmarks?category_id={category_id}&tag_id={tag_id}&visibility={visibility}`：根据分类、标签和可见性过滤书签。
    - **参数**：
        - `category_id`: 分类ID（可选）
        - `tag_id`: 标签ID（可选）
        - `visibility`: 可见性（公开、私有、共享）


是的，提供通过分享链接查看书签的功能可以增强用户体验和书签的可访问性。以下是关于如何实现这一功能的设计建议：

### 7. 分享链接功能设计

#### 功能
- 用户可以选择将书签设为可分享，并生成一个唯一的链接。
- 其他用户通过该链接可以查看书签的详细信息。
- 分享只能查看，不能编辑。

#### 字段

- `shared_id`：唯一标识符 uuid
- `bookmark_id`：书签ID
- `share_link`：唯一的分享链接
- `share_password`：分享密码
- `share_expiration`：分享链接的有效期（单位：天）
- `created_at`：创建时间
- `updated_at`：更新时间


#### API 设计
- `POST /api/bookmarks/:bookmark_id/share`：生成分享链接。
    - **返回**：生成的 `share_link`。

- `GET /api/bookmarks/share/:share_link`：通过分享链接查看书签。
    - **返回**：对应书签的详细信息。

#### 安全性考虑
- 可以设置分享链接的有效期，过期后链接失效。
- 可以限制分享链接的访问权限，如只允许查看而不允许编辑。

#### 示例流程
1. 用户在书签详情页面点击“分享”按钮。
2. 系统生成一个唯一的分享链接，并返回给用户。
3. 用户将链接分享给朋友或同事。
4. 其他用户通过点击链接访问书签，查看书签的详细信息。


### 8. 访问记录

#### 功能
- 记录用户访问书签的历史记录。 访问次数，同一个来源只记录一次。 用户id 或浏览器指纹作为唯一标识。

#### 字段

- `record_id`：唯一标识符 uuid
- `user_id`：用户ID
- `bookmark_id`：书签ID
- `record_browser_fingerprint`：浏览器指纹
- `user_agent`：浏览器信息
- `record_ip`：访问IP
- `record_city`：访问城市
- `record_country`：访问国家
- `record_region`：访问地区
- `record_timezone`：时区
- `record_source`：访问来源
- `created_at`：创建时间
- `updated_at`：更新时间

### 9. 操作记录

#### 功能
- 记录用户操作的历史记录。
- 登录、注册、退出等操作记录。
- 书签的创建、更新、删除等操作记录。
- 书签的分享、取消分享等操作记录。
- 书签的共享、取消共享等操作记录。

### 10.收藏

#### 功能
- 收藏书签
- 取消收藏

#### 字段

- `collection_id`：唯一标识符 uuid
- `user_id`：用户ID
- `bookmark_id`：书签ID
- `folder_id`：收藏夹ID (可选)
- `created_at`：创建时间
- `updated_at`：更新时间